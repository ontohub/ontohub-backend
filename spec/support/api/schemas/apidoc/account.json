{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Account",
  "description": "Endpoint to create, modify or delete a user account",

  "type": {"$ref": "../models/session_model.json#/type"},
  "required": {"$ref": "../models/session_model.json#/required"},
  "properties": {"$ref": "../models/session_model.json#/properties"},

  "links": [
    {
      "title": "Sign Up",
      "description": "Sign up as a user. Returns HTTP 201 (Created).",
      "rel": "self",
      "href": "/users",
      "method": "POST",

      "requestHeaders": {
        "required": ["Content-Type"],
        "properties": {
          "Content-Type": {
            "enum": ["application/json"],
            "example": "application/json"
          }
        }
      },

      "schema": {
        "type": "object",
        "required": ["user"],
        "properties": {
          "user": {
            "description": "The credentials of the user.",
            "type": "object",
            "required": ["name", "email", "password", "captcha"],
            "properties": {
              "name": {
                "type": "string",
                "description": "The name (id) of the user to sign in",
                "example": "ada"
              },
              "display_name": {"$ref": "../models/user_model.json#/properties/attributes/properties/display_name"},
              "email": {"$ref": "../models/user_model.json#/properties/attributes/properties/email"},
              "password": {
                "type": "string",
                "description": "The password of the user to sign up",
                "example": "changemenow"
              },
              "catpcha": {
                "type": "string",
                "description": "A token generated by reCAPTCHA to show that you're not a robot",
                "example": "SomeCaptchaToken"
              }
            }
          }
        }
      },
      "targetSchema": {"$ref": "../controllers/v2/users/account/post_create.json"}
    },
    {
      "title": "Update",
      "description": "Change the user's details. Returns HTTP 200 (OK).",
      "rel": "self",
      "href": "/users",
      "method": "PATCH",

      "schema": {
        "type": "object",
        "required": ["data"],
        "properties": {
          "data": {
            "description": "The details of the current user that shall be changed. Only the `current_password` is required.",
            "type": "object",
            "required": ["attributes"],
            "properties": {
              "attributes": {
                "type": "object",
                "required": ["current_password"],
                "properties": {
                  "display_name": {"$ref": "../models/user_model.json#/properties/attributes/properties/display_name"},
                  "email": {"$ref": "../models/user_model.json#/properties/attributes/properties/email"},
                  "password": {
                    "type": "string",
                    "description": "The desired new password of the user",
                    "example": "changemeagain"
                  },
                  "current_password": {
                    "type": "string",
                    "description": "The current password of the user to legitimate the request",
                    "example": "changemenow"
                  }
                }
              }
            }
          }
        }
      },
      "targetSchema": {"$ref": "../controllers/v2/users/account/post_create.json"}
    },
    {
      "title": "Delete",
      "description": "Delete the user and all their repositories. Returns HTTP 204 (No Content).",
      "rel": "self",
      "href": "/users",
      "method": "DELETE"
    }
  ]
}
