{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Repositories",
  "description": "Endpoints for repositories",

  "type": {"$ref": "../models/repository_model.json#/type"},
  "required": {"$ref": "../models/repository_model.json#/required"},
  "properties": {"$ref": "../models/repository_model.json#/properties"},

  "definitions": {
    "requestSchema": {
      "_comment_": "We need to duplicate the attributes because we don't require the description attribute in the request, but we always include it in the response.",
      "type": "object",
      "required": ["data"],
      "properties": {
        "data": {
          "description": "The 'description' attribute is optional. All other attributes and the relationships are required fields.",
          "type": "object",
          "required": ["attributes", "relationships"],
          "properties": {
            "attributes": {
              "type": "object",
              "required": ["name", "content_type", "public_access"],
              "properties": {
                "name": {"$ref": "../models/repository_model.json#/properties/attributes/properties/name"},
                "description": {"$ref": "../models/repository_model.json#/properties/attributes/properties/description"},
                "content_type": {"$ref": "../models/repository_model.json#/properties/attributes/properties/content_type"},
                "public_access": {"$ref": "../models/repository_model.json#/properties/attributes/properties/public_access"}
              }
            },
            "relationships": {"$ref": "../models/repository_model.json#/properties/relationships"}
          }
        }
      }
    }
  },

  "links": [
    {
      "title": "Create",
      "description": "Create a new repository. Returns HTTP 201 (Created).",
      "rel": "self",
      "href": "/repositories",
      "method": "POST",
      "schema": {"$ref": "#/definitions/requestSchema"},
      "targetSchema": {"$ref": "../controllers/v2/repositories/post_create.json"},
      "mediaType": "application/vnd.api+json"
    },
    {
      "title": "Show (explicit)",
      "description": "Show the details of a specific repository. Returns HTTP 200 (OK).",
      "rel": "self",
      "href": "/repositories/:repository_id",
      "method": "GET",
      "targetSchema": {"$ref": "../controllers/v2/repositories/get_show.json"},
      "mediaType": "application/vnd.api+json"
    },
    {
      "title": "Show (inferred)",
      "description": "Show the details of a specific repository. If the :repository_id parameter is a repository's ID, it responds with a repository. Returns HTTP 200 (OK).",
      "rel": "self",
      "href": "/:repository_id",
      "method": "GET",
      "targetSchema": {"$ref": "../controllers/v2/repositories/get_show.json"},
      "mediaType": "application/vnd.api+json"
    },
    {
      "title": "Update",
      "description": "Change the repository. Returns HTTP 200 (OK).",
      "rel": "self",
      "href": "/repositories/:repository_id",
      "method": "PATCH",
      "schema": {"$ref": "#/definitions/requestSchema"},
      "targetSchema": {"$ref": "../controllers/v2/repositories/patch_update.json"},
      "mediaType": "application/vnd.api+json"
    },
    {
      "title": "Delete",
      "description": "Delete a repository completely with all its contents. Returns HTTP 204 (No Content)",
      "rel": "self",
      "href": "/repositories/:repository_id",
      "method": "DELETE",
      "mediaType": "application/vnd.api+json"
    }
  ]
}
