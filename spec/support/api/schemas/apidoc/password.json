{
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "Reset Password",
  "description": "Endpoint to reset a user's password",

  "links": [
    {
      "title": "Send the reset password email",
      "description": "Request to send the email with instruction to reset the password. Returns HTTP 201 (Created).",
      "rel": "self",
      "href": "/users/password",
      "method": "POST",

      "requestHeaders": {
        "required": ["Content-Type"],
        "properties": {
          "Content-Type": {
            "enum": ["application/json"],
            "example": "application/json"
          }
        }
      },

      "schema": {
        "type": "object",
        "required": ["data"],
        "properties": {
          "data": {
            "type": "object",
            "required": ["attributes"],
            "properties": {
              "attributes": {
                "description": "Attributes of the user to send the email to",
                "type": "object",
                "required": ["email"],
                "properties": {
                  "email": {
                    "description": "The email address of the user to send the email to",
                    "example": "ada@example.com",
                    "type": "string",
                    "pattern": "[^@]+@[^@]+"
                  }
                }
              }
            }
          }
        }
      },
      "targetSchema": {"$ref": "../controllers/v2/users/passwords/post_create.json"}
    },
    {
      "title": "Reset the password with a token",
      "description": "Reset the password by using the token from the email. Returns HTTP 200 (OK).",
      "rel": "self",
      "href": "/users/password",
      "method": "PATCH",

      "requestHeaders": {
        "required": ["Content-Type"],
        "properties": {
          "Content-Type": {
            "enum": ["application/json"],
            "example": "application/json"
          }
        }
      },

      "schema": {
        "type": "object",
        "required": ["data"],
        "properties": {
          "data": {
            "type": "object",
            "required": ["attributes"],
            "properties": {
              "attributes": {
                "description": "Attributes of the user to send the email to",
                "type": "object",
                "required": ["reset_password_token", "password"],
                "properties": {
                  "reset_password_token": {
                    "description": "The token that was sent with the email",
                    "example": "LcbGLkvo37xcw2uti9Lb",
                    "type": "string"
                  },
                  "password": {
                    "type": "string",
                    "description": "The desired new password of the user",
                    "example": "changemeagain"
                  }
                }
              }
            }
          }
        }
      },
      "targetSchema": {"$ref": "../controllers/v2/users/passwords/patch_update.json"}
    }
  ]
}
